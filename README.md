üåê –î–æ—Å—Ç—É–ø–Ω—ã–µ —è–∑—ã–∫–∏: [–†—É—Å—Å–∫–∏–π](README.md) | [English](README.en.md)

# üåê Marzban Custom Subscription Page  
**–ì–æ—Ç–æ–≤—ã–π HTML-—à–∞–±–ª–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è –ø–∞–Ω–µ–ª–∏ Marzban (–∑–∞–º–µ–Ω–∞ `/subscription/<username>`).**

–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è ‚Äî –≤—Å–µ —Å—Ç–∏–ª–∏, —Å–∫—Ä–∏–ø—Ç—ã, –∏–∫–æ–Ω–∫–∏, —Å–ª–æ–≤–∞—Ä–∏ –∏ –ª–æ–≥–∏–∫–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞  
`template_subscription_index.html`.

–®–∞–±–ª–æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º Marzban –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (uuid, —Å—Ä–æ–∫, –ª–∏–º–∏—Ç—ã, inbounds, –ø–æ–¥–ø–∏—Å–æ—á–Ω—ã–π URL) —á–µ—Ä–µ–∑ Jinja.

---

# üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîÑ –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã Marzban  
- üîó –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ `subscription_url`, `user`, `inbounds`, `xray_config_base64`  
- üì± Deeplink-–∏–º–ø–æ—Ä—Ç –≤ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã (V2RayTun, Sing-box, Hiddify –∏ –¥—Ä.)  
- üåç –ú–Ω–æ–≥–æ—è–∑—ã—á–∏–µ (ru/en), —Å–ª–æ–≤–∞—Ä–∏ –≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ —Ñ–∞–π–ª  
- üé® –ö—Ä–∞—Å–∏–≤—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ Bootstrap + –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π CSS  
- üß© –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ SVG-–∏–∫–æ–Ω–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π  
- üß™ –í—Å—è –ª–æ–≥–∏–∫–∞ ‚Äî –≤ –æ–¥–Ω–æ–º HTML-—Ñ–∞–π–ª–µ, –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π  

---

# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
marzban-sub-page/
‚îî‚îÄ‚îÄ template_subscription_index.html   # –æ–¥–∏–Ω —Ñ–∞–π–ª, –≤–∫–ª—é—á–∞—é—â–∏–π CSS+JS+SVG+–ª–æ–≥–∏–∫–∞
```

---

# üîå –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Marzban

## 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` –≤–∫–ª—é—á–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤

–í —Ñ–∞–π–ª–µ `/opt/marzban/.env` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞:

```
CUSTOM_TEMPLATES_DIRECTORY="/var/lib/marzban/templates/"
```

Marzban –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç —à–∞–±–ª–æ–Ω—ã –∏–∑ —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

---

## 2. –°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –¥–ª—è —à–∞–±–ª–æ–Ω–∞

```bash
sudo mkdir -p /var/lib/marzban/templates/subscription/
```

---

## 3. –ü–æ–º–µ—Å—Ç–∏—Ç–µ —à–∞–±–ª–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–¥–ø–∏—Å–∫–∏ –≤ –Ω—É–∂–Ω—ã–π –ø—É—Ç—å

```bash
sudo cp template_subscription_index.html      /var/lib/marzban/templates/subscription/index.html
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ Marzban –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω—ë—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à —à–∞–±–ª–æ–Ω.

---

## 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Marzban

```bash
docker compose down
docker compose up -d
```

---

# üìå –ê–¥—Ä–µ—Å, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ—Å—Ç—É–ø–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–¥–ø–∏—Å–æ—á–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ —Å—Å—ã–ª–∫–µ –≤–∏–¥–∞:

```
https://<domain>/sub/<base64-token>
```

–ù–∞–ø—Ä–∏–º–µ—Ä:

```
https://marzban-s2.vpn-for-friends.com:4443/sub/dXNfMjI5LDE3NjM2...
```

–≠—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π URL.

---

# üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è (—É—Å—Ç–∞—Ä–µ–≤—à–∞—è) —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ volume

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∑–∞–º–µ–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω –Ω–∞–ø—Ä—è–º—É—é –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

```yaml
services:
  marzban:
    volumes:
      - /opt/marzban/template_subscription_index.html:/code/app/templates/subscription/index.html
```

–ù–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `CUSTOM_TEMPLATES_DIRECTORY` **—ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –Ω–µ –Ω—É–∂–µ–Ω**.

---

# üß¨ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (Jinja)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| `subscription_url` | URL –ø–æ–¥–ø–∏—Å–∫–∏ (`/sub/<uuid>`) |
| `panel_url` | URL –ø–∞–Ω–µ–ª–∏ |
| `user` | –û–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `user.uuid` | UUID |
| `user.username` | –õ–æ–≥–∏–Ω |
| `user.expire_date` | –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è |
| `user.data_limit` | –õ–∏–º–∏—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ |
| `user.data_limit_reset_strategy` | –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–±—Ä–æ—Å–∞ |
| `user.sub_status` | –°—Ç–∞—Ç—É—Å |
| `user.on_hold_expire_duration` | –ó–∞–º–æ—Ä–æ–∑–∫–∞ |
| `inbounds` | –°–ø–∏—Å–æ–∫ –∏–Ω–±–∞—É–Ω–¥–æ–≤ |
| `xray_config_base64` | Base64-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |

---

# üß© –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –≤–Ω—É—Ç—Ä–∏ —à–∞–±–ª–æ–Ω–∞

### –°—Å—ã–ª–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
```html
<a href="{{ subscription_url }}" class="btn btn-primary">Download subscription</a>
```

### –í—ã–≤–æ–¥ UUID
```html
<p>Your UUID: {{ user.uuid }}</p>
```

### –ò–Ω–±–∞—É–Ω–¥—ã
```html
{% for ib in inbounds %}
  <li>{{ ib.remark }} ‚Äî {{ ib.address }}:{{ ib.port }}</li>
{% endfor %}
```

---

# üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º HTML-—Ñ–∞–π–ª–µ.  
–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω—è—Ç—å:

## üî∏ –ü–µ—Ä–µ–≤–æ–¥—ã (MESSAGES)

–í–Ω—É—Ç—Ä–∏ `<script>` —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –æ–±—ä–µ–∫—Ç:

```js
const MESSAGES = { ru: {...}, en: {...} }
```

–ú–æ–∂–Ω–æ:

- –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–µ–∫—Å—Ç—ã  
- –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —è–∑—ã–∫–∏ (`fa`, `zh`, `tr`‚Ä¶)  
- –º–µ–Ω—è—Ç—å —è–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é  

---

## üî∏ Deeplink-—Å—Å—ã–ª–∫–∏

–§—É–Ω–∫—Ü–∏–∏:

```js
setupLink("href-v2raytun");
setupLink("href-singbox");
```

—Ñ–æ—Ä–º–∏—Ä—É—é—Ç deeplink URL –Ω–∞ –æ—Å–Ω–æ–≤–µ `{{ subscription_url }}`.

---

## üî∏ –°—Ç–∏–ª–∏

CSS –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `<style>` –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ ‚Äî –≤—ã –º–æ–∂–µ—Ç–µ –º–µ–Ω—è—Ç—å:

- —Ü–≤–µ—Ç–æ–≤—É—é —Ç–µ–º—É  
- —Ñ–æ–Ω  
- —Ä–∞–∑–º–µ—Ä—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤  
- –∫–Ω–æ–ø–∫–∏ –∏ –∫–∞—Ä—Ç–æ—á–∫–∏  
- –ª–æ–≥–æ—Ç–∏–ø  

---

## üî∏ –ò–∫–æ–Ω–∫–∏

SVG-—Å–ø—Ä–∞–π—Ç –≤—Å—Ç—Ä–æ–µ–Ω –≤–Ω—É—Ç—Ä–∏ HTML-—Ñ–∞–π–ª–∞.  
–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∑–Ω–∞—á–æ–∫ ‚Äî –≤—Å—Ç–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π `<symbol>`.

---

## üñºÔ∏è –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã

![Preview](assets/img/screenshot.png)

---

# ü§ù –í–∫–ª–∞–¥

PR-—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!  
–í—ã –º–æ–∂–µ—Ç–µ:

- —É–ª—É—á—à–∏—Ç—å UI  
- –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —è–∑—ã–∫–∏  
- —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤  
- —É–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É deeplink  

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **MIT**.  
–°–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã.

---

**–ê–≤—Ç–æ—Ä:** [Sergey Ryabkov](https://github.com/ryabkov82)  
**–ü—Ä–æ–µ–∫—Ç:** [VPN for Friends](https://t.me/vpn_for_myfriends_bot)
