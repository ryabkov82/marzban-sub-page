ğŸŒ Available languages: [English](README.md) | [Ğ ÑƒÑÑĞºĞ¸Ğ¹](README.ru.md)

# ğŸŒ Marzban Custom Subscription Page
A fully custom HTML subscription page for the Marzban panel  
(replaces the user-facing `/sub/<token>` page).

This project provides a **single standalone HTML file** containing all CSS, JavaScript, SVG icons, translations, and UI logic.  
Marzban automatically loads custom templates from the directory specified in:

```
CUSTOM_TEMPLATES_DIRECTORY="/var/lib/marzban/templates/"
```

---

# ğŸš€ Features

- ğŸ”„ Complete replacement of the default Marzban subscription page  
- ğŸ”— Automatic integration of Jinja variables: `subscription_url`, `user`, `inbounds`, `xray_config_base64`  
- ğŸ“± Oneâ€‘click client import (V2RayTun, Sing-box, Hiddify, etc.)  
- ğŸŒ Multilingual (EN/RU) â€” translations embedded in the file  
- ğŸ¨ Modern Bootstrapâ€‘based UI with inline CSS  
- ğŸ§© Embedded SVG icons  
- âš™ï¸ No external dependencies â€” everything lives inside one HTML file  

---

# ğŸ“ Project Structure

```
marzban-sub-page/
â””â”€â”€ template_subscription_index.html   # the single combined CSS+JS+SVG template
```

---

# ğŸ”Œ Installation & Integration with Marzban

## 1. Ensure custom templates are enabled in `.env`

In `/opt/marzban/.env` you must have:

```
CUSTOM_TEMPLATES_DIRECTORY="/var/lib/marzban/templates/"
```

This makes Marzban read templates from that directory.

---

## 2. Create the directory structure for the template

```bash
sudo mkdir -p /var/lib/marzban/templates/subscription/
```

---

## 3. Copy the template into place

```bash
sudo cp template_subscription_index.html      /var/lib/marzban/templates/subscription/index.html
```

Marzban will automatically start using your custom template.

---

## 4. Restart Marzban

```bash
docker compose down
docker compose up -d
```

---

# ğŸ“Œ URL where the page is available

Users access the subscription page via the URL generated by Marzban:

```
https://<domain>/sub/<base64-token>
```

Example:

```
https://marzban-s2.vpn-for-friends.com:4443/sub/dXNfMjI5LDE3NjM2...
```

This is the **correct and only** public route for subscription pages.

---

# ğŸ”„ Alternative legacy installation via volume (not recommended)

If you prefer overriding the internal container file:

```yaml
services:
  marzban:
    volumes:
      - /opt/marzban/template_subscription_index.html:/code/app/templates/subscription/index.html
```

But when using `CUSTOM_TEMPLATES_DIRECTORY`, **this is unnecessary**.

---

# ğŸ§¬ Supported Jinja Variables

| Variable | Description |
|---------|-------------|
| `subscription_url` | Subscription URL (`/sub/<token>`) |
| `panel_url` | Panel base URL |
| `user` | User object |
| `user.uuid` | UUID |
| `user.username` | Username |
| `user.expire_date` | Expiration date |
| `user.data_limit` | Data cap |
| `user.data_limit_reset_strategy` | Reset strategy |
| `user.sub_status` | Status |
| `user.on_hold_expire_duration` | Freeze duration |
| `inbounds` | List of inbound nodes |
| `xray_config_base64` | Base64â€‘encoded config |

---

# ğŸ§© Template Usage Examples

### Subscription link
```html
<a href="{{ subscription_url }}" class="btn btn-primary">Download subscription</a>
```

### UUID output
```html
<p>Your UUID: {{ user.uuid }}</p>
```

### Iterating through inbounds
```html
{% for ib in inbounds %}
  <li>{{ ib.remark }} â€” {{ ib.address }}:{{ ib.port }}</li>
{% endfor %}
```

---

# ğŸ¨ Customization

Everything is contained inside one HTML file. You can modify:

## ğŸ”¸ Translations (MESSAGES)

Found inside `<script>`:

```js
const MESSAGES = { en: {...}, ru: {...} }
```

You may:

- modify text  
- add languages (`fa`, `zh`, `tr`, etc.)  
- change the default language  

---

## ğŸ”¸ Deeplink generation

Functions like:

```js
setupLink("href-v2raytun");
setupLink("href-singbox");
```

generate client import links using `{{ subscription_url }}`.

---

## ğŸ”¸ Styles

CSS is stored inside a `<style>` block. You can customize:

- color theme  
- layout  
- buttons/cards  
- logos  
- spacing and typography  

---

## ğŸ”¸ Icons

SVG sprite is fully embedded in the HTML file.  
Add new icons by inserting new `<symbol>` elements.

---

# ğŸ¤ Contributing

Pull requests are welcome!

---

# ğŸ“œ License
MIT License  
Author: Sergey Ryabkov  
Project: VPN for Friends
